!function(e){e.module("authomator",[])}(angular),function(e){function t(){function t(e,t,i){return new n(e,t,i,o)}var o={authomatorUrl:"",automaticallyRefreshTokens:!0,statePredicateFunction:null,routePredicateFunction:null,accessTokenQueryStringKey:"at",identityTokenQueryStringKey:"it",refreshTokenQueryStringKey:"rt"};this.setOptions=function(t){return e.extend(o,t),this},this.$get=t,t.$inject=["$rootScope","$location","jwtHelpers"]}function n(t,n,o,i){this._options=i,this._accessToken=null,this._identityToken=null,this._refreshToken=null,this.init=function(){this._listenForQueryStringKeys(),this._listenForRouteChanges(),this._listenForStateChanges()},this._listenForRouteChanges=function(){var n=this;e.isFunction(this._options.routePredicateFunction)&&t.$on("$routeChangeStart",function(e,t,o){n._options.routePredicateFunction(e,t,o)})},this._listenForStateChanges=function(){var n=this;e.isFunction(this._options.statePredicateFunction)&&t.$on("$stateChangeStart",function(e,t,o,i,r){n._options.statePredicateFunction(e,t,o,i,r)})},this._listenForQueryStringKeys=function(){var e=this;t.$on("$locationChangeStart",function(){var t=n.search();t.hasOwnProperty(e._options.accessTokenQueryStringKey)&&t.hasOwnProperty(e._options.identityTokenQueryStringKey)&&t.hasOwnProperty(e._options.refreshTokenQueryStringKey)&&(e.setAccessToken(t[e._options.accessTokenQueryStringKey]),e.setIdentityToken(t[e._options.identityTokenQueryStringKey]),e.setRefreshToken(t[e._options.refreshTokenQueryStringKey]))})},this.setAccessToken=function(e){var n=o.decodeToken(e);return this._accessToken=e,t.$emit("authomator.accessTokenUpdated",n),this},this.getAccessToken=function(){return this._accessToken},this.setIdentityToken=function(e){var n=o.decodeToken(e);return this._identityToken=e,t.$emit("authomator.identityTokenUpdated",n),this},this.getIdentityToken=function(){return this._identityToken},this.setRefreshToken=function(e){var n=o.decodeToken(e);return this._refreshToken=e,t.$emit("authomator.refreshTokenUpdated",n),this},this.getRefreshToken=function(){return this._refreshToken}}function o(e){e.init()}o.$inject=["authomator"],e.module("authomator").run(o),e.module("authomator").provider("authomator",t)}(angular),function(e){function t(e){this.urlBase64Decode=function(t){var n=t.replace(/-/g,"+").replace(/_/g,"/");switch(n.length%4){case 0:break;case 2:n+="==";break;case 3:n+="=";break;default:throw"Illegal base64url string!"}return e.decodeURIComponent(e.escape(e.atob(n)))},this.decodeToken=function(e){var t,n=e.split(".");return 3!==n.length?null:(t=this.urlBase64Decode(n[1]),t?JSON.parse(t):null)},this.getTokenExpirationDate=function(e){var t=this.decodeToken(e);if(!t.exp)return null;var n=new Date(0);return n.setUTCSeconds(t.exp),n},this.isTokenExpired=function(e){var t=this.getTokenExpirationDate(e);return t?t.valueOf()<=(new Date).valueOf():!1}}t.$inject=["$window"],e.module("authomator").service("jwtHelpers",t)}(angular);